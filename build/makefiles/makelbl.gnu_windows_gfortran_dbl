# Makefile for lblrtm
# $Id$

SHELL = /bin/sh

###############################
# Set variables
###############################

PLATFORM = WINOWS

FC = gfortran 
FCFLAG =   -fdefault-integer-8 -fdefault-real-8 -Wall -frecord-marker=4
CPATH = ..\\src\\
exec_path = ..\\

CDOTO = gnu_gfortran_dbl.o
exec  = lblrtm_v11.5_gnu_windows_gfortran_dbl

OUTPUT = $(exec_path)$(exec)

CLBL = lblrtm
COPR = oprop
CCNT = contnm
CXMG = xmerge
CTST = testmm
CATM = lblatm
CLOW = lbllow
CPST = postsub
CFFT = fftscn
CPLT = pltlbl
CUTL = util_gfortran
CDUM = lbldum
CSOL = solar
CNLT = nonlte


OBJFIL = $(CLBL).o \
         $(COPR).o \
         $(CCNT).o \
         $(CXMG).o \
         $(CTST).o \
         $(CATM).o \
         $(CLOW).o \
         $(CPST).o \
         $(CFFT).o \
         $(CPLT).o \
         $(CUTL).o \
         $(CDUM).o \
         $(CSOL).o \
         $(CNLT).o 

OBPATH = $(CDOTO)\\$(CLBL).o \
         $(CDOTO)\\$(COPR).o \
         $(CDOTO)\\$(CCNT).o \
         $(CDOTO)\\$(CXMG).o \
         $(CDOTO)\\$(CTST).o \
         $(CDOTO)\\$(CATM).o \
         $(CDOTO)\\$(CLOW).o \
         $(CDOTO)\\$(CPST).o \
         $(CDOTO)\\$(CFFT).o \
         $(CDOTO)\\$(CPLT).o \
         $(CDOTO)\\$(CUTL).o \
         $(CDOTO)\\$(CDUM).o \
         $(CDOTO)\\$(CSOL).o \
         $(CDOTO)\\$(CNLT).o

MODULE = $(CPATH)\\$(CLBL).f \
         $(CPATH)\\$(COPR).f \
         $(CPATH)\\$(CCNT).f \
         $(CPATH)\\$(CXMG).f \
         $(CPATH)\\$(CTST).f \
         $(CPATH)\\$(CATM).f \
         $(CPATH)\\$(CLOW).f \
         $(CPATH)\\$(CPST).f \
         $(CPATH)\\$(CFFT).f \
         $(CPATH)\\$(CPLT).f \
         $(CPATH)\\$(CUTL).f \
         $(CPATH)\\$(CDUM).f \
         $(CPATH)\\$(CSOL).f \
         $(CPATH)\\$(CNLT).f


###############################
# Load line
###############################

$(OUTPUT) : \
	intro makedir $(OBPATH) conclude
	$(FC) $(FCFLAG) -o $(OUTPUT) $(OBPATH)


###############################
# Object compile lines
###############################


$(CDOTO)\\$(COPR).o : $(CPATH)\\$(COPR).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(COPR).f -o $(CDOTO)\\$(COPR).o

$(CDOTO)\\$(CLBL).o : $(CPATH)\\$(CLBL).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CLBL).f -o $(CDOTO)\$(CLBL).o

$(CDOTO)\\$(CCNT).o : $(CPATH)\\$(CCNT).f
	$(FC) $(FCFLAG) -c $(CPATH)$(CCNT).f -o $(CDOTO)\\$(CCNT).o

$(CDOTO)\\$(CXMG).o : $(CPATH)\\$(CXMG).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CXMG).f -o $(CDOTO)\\$(CXMG).o

$(CDOTO)\\$(CTST).o : $(CPATH)\\$(CTST).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CTST).f -o $(CDOTO)\\$(CTST).o

$(CDOTO)\\$(CATM).o : $(CPATH)\\$(CATM).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CATM).f -o $(CDOTO)\\$(CATM).o

$(CDOTO)\\$(CLOW).o : $(CPATH)\\$(CLOW).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CLOW).f -o $(CDOTO)\\$(CLOW).o

$(CDOTO)\\$(CPST).o : $(CPATH)\\$(CPST).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CPST).f -o $(CDOTO)\\$(CPST).o 

$(CDOTO)\\$(CFFT).o : $(CPATH)\\$(CFFT).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CFFT).f -o $(CDOTO)\\$(CFFT).o

$(CDOTO)\\$(CPLT).o : $(CPATH)\\$(CPLT).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CPLT).f -o $(CDOTO)\\$(CPLT).o

$(CDOTO)\\$(CUTL).o : $(CPATH)\\$(CUTL).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CUTL).f -o $(CDOTO)\\$(CUTL).o

$(CDOTO)\\$(CDUM).o : $(CPATH)\\$(CDUM).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CDUM).f -o $(CDOTO)\\$(CDUM).o

$(CDOTO)\\$(CSOL).o : $(CPATH)\\$(CSOL).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CSOL).f -o $(CDOTO)\\$(CSOL).o

$(CDOTO)\\$(CNLT).o : $(CPATH)\\$(CNLT).f
	$(FC) $(FCFLAG) -c $(CPATH)\\$(CNLT).f -o $(CDOTO)\\$(CNLT).o


###############################
# Create object file directory
###############################

makedir :
        #rmdir /S/Q $(CDOTO)
	mkdir $(CDOTO) 


###############################
# Intro information
###############################

.SILENT:
intro :
	echo
	echo '-----------------'
	echo '  $(OUTPUT) Makefile'
	echo '-----------------'
	echo
	echo 'This Makefile was designed for the $(PLATFORM) platform.'
	echo
	echo 'It uses the $(FC) compiler, with the following options:'
	echo '      $(FCFLAG)'
	echo
	echo 'The object files used are as follows:'
	echo
	echo '      $(OBJ)'
	echo
	echo
	echo '$(OUTPUT) make in progress ...'
	echo



###############################
# Concluding information
###############################

conclude :
	echo
	echo '================='
	echo '  Makefile done'
	echo '================='


